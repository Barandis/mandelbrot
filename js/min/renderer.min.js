(function(){define(["jquery","./algorithm"],function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;return c=3.4,d=0,e=!1,f=function(c,f,g,n){var o,p,q,r,s,t,u,v,w,x,y;e=!1,o=b.palettes[n.palette],p=m(n),q=p[0],r=p[1],n.autoDepth&&(s=Math.sqrt(.001+2*Math.min(Math.abs(q[0]-q[1]),Math.abs(r[0]-r[1]))),n.depth=Math.floor(223/s)),t=(q[1]-q[0])/(c.width-.5),u=(r[1]-r[0])/(c.height-.5),h(n),i(n,q,r),d++,v=function(a,d,e){var f,h,i,j,k,l,m;for(null==e&&(e=0),f=a,h=n.escape,i=n.depth,j=0,k=c.width;k>=j;++j)l=b.mandelbrot(f,d,h,i),m=o(i,l[0],l[1],l[2]),g.data[e++]=m[0],g.data[e++]=m[1],g.data[e++]=m[2],g.data[e++]=255,f+=t},w=function(a,d,e){var f,h,i,l,m,p,q,r,s,v,w;for(null==e&&(e=0),f=a,h=n.escape,i=n.depth,l=n.supersamples,m=0,p=c.width;p>=m;++m){for(q=[0,0,0,255],r=0;l>=r;++r)s=Math.random()*t,v=Math.random()*u,w=b.mandelbrot(f-s/2,d-v/2,h,i),j(q,o(i,w[0],w[1],w[2]));k(q,l),g.data[e++]=q[0],g.data[e++]=q[1],g.data[e++]=q[2],g.data[e++]=255,f+=t}},x=function(a,b){var d,e,f;for(d=a*c.width,e=0,f=c.width;f>=e;++e)g.data[d++]=b[0],g.data[d++]=b[1],g.data[d++]=b[2],g.data[d++]=b[3]},(y=function(){var b,h,i,j,k,m,o,p,s,t;b=Date.now(),h=c.height,i=c.width,j=b,k=0,m=r[0],o=0,p=n.supersamples>1?w:v,s=d,a("#size").text(c.width+" x "+c.height),(t=function(){var r,v,w;e||s!==d||h!==c.height||i!==c.width||(p(q[0],m),m+=u,k+=c.width,f.putImageData(g,0,o),r=Date.now(),o++<c.height?r-j>=n.update?(x(0,[255,59,3,255]),f.putImageData(g,0,o),v=r-b,a("#render-time").text((v/1e3).toFixed(1)),w=1e3*k/v,"NaN"===l(w).substr(0,3)?(w=Math.floor(60*k/v),a("#render-unit").text("min")):a("#render-unit").text("s"),a("#render-speed").text(l(w)),a("#pixels").text(l(k)+"px"),j=r,setTimeout(t,0)):t():a("#pixels").text(l(k)))})()})()},g=function(a){var b,c;b=a[0]/a[1],c=window.innerWidth/window.innerHeight,c>b?a[0]*=c/b:a[1]*=b/c},h=function(a){var b,c,d,e,f,g,h,i,j,k;b=a.re,c=a.im,d=a.zoom,e=a.escape,f=a.depth,g=a.autoDepth,h=a.supersamples,i=a.palette,j=a.update,k=g?1:0,window.location.hash="r="+b+"&i="+c+"&z="+d+"&e="+e+"&d="+f+"&a="+k+"&s="+h+"&p="+i+"&u="+j},i=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;e=b.re,f=b.im,g=b.zoom,h=b.escape,i=b.depth,j=b.autoDepth,k=b.supersamples,l=b.palette,m=b.update,a("#re").val(e),a("#im").val(f),a("#zoom").val(g),a("#escape").val(h),a("#depth").val(i),a("#update").val(m),a("#auto-depth").prop("checked",j),a("#palette").val(l),a("#supersamples").val(k),n=c[0],o=c[1],p=d[0],q=d[1],r=Math.abs(n-o),s=Math.abs(p-q),a("#domain span").html("d<sub>Re</sub> = "+r+" | d<sub>Im</sub> = "+s)},j=function(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3]},k=function(a,b){a[0]/=b,a[1]/=b,a[2]/=b,a[3]/=b},l=function(a,b){var c,d,e;return null==b&&(b=2),c=["","k","M","G","T","P","E"],d=Math.floor(Math.floor(Math.log(a)/Math.LN10)/3),e=(a/Math.pow(10,3*d)).toFixed(b),e+" "+c[d]},m=function(a){var b;return b=[c/a.zoom,c/a.zoom],g(b),[[a.re-b[0]/2,a.re+b[0]/2],[a.im+b[1]/2,a.im-b[1]/2]]},n=function(){e=!0},{render:f,stop:n,getRange:m}})}).call(this);