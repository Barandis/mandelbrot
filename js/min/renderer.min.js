(function(){define(["jquery","./algorithm"],function(a,b){var c,d,e,f,g,h,i,j,k,l;return c=3.4,d=0,e=function(c,e,f,m){var n,o,p,q,r,s,t,u,v,w,x;n=b.palettes[m.palette],o=l(m),p=o[0],q=o[1],m.autoDepth&&(r=Math.sqrt(.001+2*Math.min(Math.abs(p[0]-p[1]),Math.abs(q[0]-q[1]))),m.depth=Math.floor(223/r)),s=(p[1]-p[0])/(c.width-.5),t=(q[1]-q[0])/(c.height-.5),g(m),h(m,p,q),d++,u=function(a,d,e){var g,h,i,j,k,l,o;for(null==e&&(e=0),g=a,h=m.escape,i=m.depth,j=0,k=c.width;k>=j;++j)l=b.mandelbrot(g,d,h,i),o=n(i,l[0],l[1],l[2]),f.data[e++]=o[0],f.data[e++]=o[1],f.data[e++]=o[2],f.data[e++]=255,g+=s},v=function(a,d,e){var g,h,k,l,o,p,q,r,u,v,w;for(null==e&&(e=0),g=a,h=m.escape,k=m.depth,l=m.supersamples,o=0,p=c.width;p>=o;++o){for(q=[0,0,0,255],r=0;l>=r;++r)u=Math.random()*s,v=Math.random()*t,w=b.mandelbrot(g-u/2,d-v/2,h,k),i(q,n(k,w[0],w[1],w[2]));j(q,l),f.data[e++]=q[0],f.data[e++]=q[1],f.data[e++]=q[2],f.data[e++]=255,g+=s}},w=function(a,b){var d,e,g;for(d=a*c.width,e=0,g=c.width;g>=e;++e)f.data[d++]=b[0],f.data[d++]=b[1],f.data[d++]=b[2],f.data[d++]=b[3]},(x=function(){var b,g,h,i,j,l,n,o,r,s;b=Date.now(),g=c.height,h=c.width,i=b,j=0,l=q[0],n=0,o=m.supersamples>1?v:u,r=d,a("#size").text(c.width+" x "+c.height),(s=function(){var q,u,v;r===d&&g===c.height&&h===c.width&&(o(p[0],l),l+=t,j+=c.width,e.putImageData(f,0,n),q=Date.now(),n++<c.height?q-i>=m.update?(w(0,[255,59,3,255]),e.putImageData(f,0,n),u=q-b,a("#render-time").text((u/1e3).toFixed(1)),v=1e3*j/u,"NaN"===k(v).substr(0,3)?(v=Math.floor(60*j/u),a("#render-unit").text("min")):a("#render-unit").text("s"),a("#render-speed").text(k(v)),a("#pixels").text(k(j)+"px"),i=q,setTimeout(s,0)):s():a("#pixels").text(k(j)))})()})()},f=function(a){var b,c;b=a[0]/a[1],c=window.innerWidth/window.innerHeight,c>b?a[0]*=c/b:a[1]*=b/c},g=function(a){var b,c,d,e,f,g,h,i,j,k;b=a.re,c=a.im,d=a.zoom,e=a.escape,f=a.depth,g=a.autoDepth,h=a.supersamples,i=a.palette,j=a.update,k=g?1:0,window.location.hash="re="+b+"&im="+c+"&zoom="+d+"&escape="+e+"&depth="+f+"&auto-depth="+k+"&supersamples="+h+"&palette="+i+"&update="+j},h=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;e=b.re,f=b.im,g=b.zoom,h=b.escape,i=b.depth,j=b.autoDepth,k=b.supersamples,l=b.palette,m=b.update,a("#re").val(e),a("#im").val(f),a("#zoom").val(g),a("#escape").val(h),a("#depth").val(i),a("#supersamples").val(k),a("#update").val(m),a("#auto-depth").prop("checked",j),a("#palette").val(l),n=c[0],o=c[1],p=d[0],q=d[1],r=Math.abs(n-o),s=Math.abs(p-q),a("#domain span").html("d<sub>Re</sub> = "+r+" | d<sub>Im</sub> = "+s)},i=function(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3]},j=function(a,b){a[0]/=b,a[1]/=b,a[2]/=b,a[3]/=b},k=function(a,b){var c,d,e;return null==b&&(b=2),c=["","k","M","G","T","P","E"],d=Math.floor(Math.floor(Math.log(a)/Math.LN10)/3),e=(a/Math.pow(10,3*d)).toFixed(b),e+" "+c[d]},l=function(a){var b;return b=[c/a.zoom,c/a.zoom],f(b),[[a.re-b[0]/2,a.re+b[0]/2],[a.im+b[1]/2,a.im-b[1]/2]]},{render:e,getRange:l}})}).call(this);